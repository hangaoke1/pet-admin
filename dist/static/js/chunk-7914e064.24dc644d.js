(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-7914e064"],{"22ce":function(e,t,i){"use strict";var a=i("365c");t["a"]={queryList:function(e){return a["a"].post("/admin/meal/queryList",e)},queryTreeList:function(e){return a["a"].post("/admin/meal/queryTreeList",e)},del:function(e){return a["a"].post("/admin/meal/del",e)},saveOrUpdate:function(e){return a["a"].post("/admin/meal/saveOrUpdate",e)}}},"365c":function(e,t,i){"use strict";i.d(t,"a",(function(){return m}));var a=i("db72"),n=i("bc3a"),s=i.n(n),r=i("5c96"),l=i("4360"),o=i("5f87"),c=s.a.create({baseURL:"http://admin.petcdd.com",withCredentials:!0,timeout:5e3});c.interceptors.request.use((function(e){return l["a"].getters.token&&(e.headers["Authorization"]=Object(o["a"])()),e}),(function(e){return Promise.reject(e)})),c.interceptors.response.use((function(e){var t=e.data;return 200!==t.code?(Object(r["Message"])({message:t.message||"Error",type:"error",duration:5e3}),900===t.code&&"/login"!==window.gvm.$route.path&&r["MessageBox"].confirm("登录状态已经过期",{confirmButtonText:"重新登录",cancelButtonText:"取消",type:"warning"}).then((function(){l["a"].dispatch("user/resetToken").then((function(){location.reload()}))})),Promise.reject(new Error(t.message||"Error"))):t}),(function(e){return console.log("接口异常"+e),Object(r["Message"])({message:e.message,type:"error",duration:5e3}),Promise.reject(e)}));var u=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return c.get(e,Object(a["a"])({params:t},i))},d=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return c.post(e,t,i)},m={get:u,post:d}},"66c4":function(e,t,i){"use strict";var a=i("b7fe"),n=i.n(a);n.a},b7fe:function(e,t,i){},c592:function(e,t,i){"use strict";var a=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("el-input",{attrs:{size:e.size,value:e.value,placeholder:e.placeholder},on:{input:e.handleInput,blur:e.handleBlur}},[i("template",{slot:"append"},[e._t("append")],2)],2)},n=[],s=(i("a481"),i("c5f6"),{name:"GNumber",props:{value:{type:[String,Number],default:""},placeholder:{type:String,default:"请输入"},size:{type:String,default:""}},methods:{handleBlur:function(e){var t=e.target.value;0==t||""==t?this.$emit("input",""):this.$emit("input",Number(t))},handleInput:function(e){if(e=this.filterNumber(e),this.isInteger&&"."===event.data)e+="1",event.target.value=e,event.target.value=e=e.substr(0,e.length-1);else{if(e.length>this.maxLength)return void(event.target.value=e.substr(0,this.maxLength));event.target.value=e}this.$emit("input",e)},filterNumber:function(e){var t=e.length,i=e.substring(0,1),a=e.substring(1,2);e=e.replace(/[^\d.]+/g,""),t>1&&"0"===i&&"."!==a&&(e=e.substring(1)),"."===i&&(e="");var n=e.indexOf(".");if(-1!==n){var s=e.substring(n+1),r=s.indexOf(".");-1!==r&&(e=e.substring(0,n+r+1)+e.substring(n+r+2))}return e}}}),r=s,l=i("2877"),o=Object(l["a"])(r,a,n,!1,null,"11b2804a",null);t["a"]=o.exports},fb0c:function(e,t,i){"use strict";i.r(t);var a=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"p-2"},[i("div",{staticClass:"bg-bai p-4"},[i("h1",{staticClass:"u-title mb-5"},[e._v("服务价目表")]),e._v(" "),i("div",{staticClass:"u-table"},[e._m(0),e._v(" "),e._l(e.list,(function(t){return i("div",{key:t.name,staticClass:"u-table__row"},[i("div",{staticClass:"row-left"},[i("img",{staticClass:"mr-1",staticStyle:{widht:"24px",height:"24px"},attrs:{src:t.icon}}),e._v(" "),i("span",[e._v(e._s(t.name))])]),e._v(" "),i("div",{staticClass:"row-right"},[e._l(t.children,(function(t){return i("div",{key:t.id,staticClass:"row-item"},[i("div",{staticClass:"content-left"},[e._v(e._s(t.name))]),e._v(" "),i("div",{staticClass:"content-right"},[i("el-button",{attrs:{type:"primary",round:""},on:{click:function(i){return e.editMeal(t)}}},[e._v("价目表")]),e._v(" "),i("el-button",{attrs:{round:""}},[e._v("删除")])],1)])})),e._v(" "),i("div",{staticClass:"row-item u-add"},[i("div",{staticClass:"u-add__line"}),e._v(" "),i("div",{staticClass:"u-add__btn",on:{click:function(i){return e.addMeal(t.name)}}},[i("i",{staticClass:"el-icon-circle-plus"}),e._v(" "),i("span",[e._v("添加")])]),e._v(" "),i("div",{staticClass:"u-add__line"})])],2)])}))],2)]),e._v(" "),i("el-dialog",{attrs:{visible:e.dialogVisible,width:"880px",top:"100px","close-on-click-modal":!1},on:{"update:visible":function(t){e.dialogVisible=t}}},[i("div",[i("div",{staticClass:"flex align-center justify-center border-bottom-divider pb-2"},[i("input",{directives:[{name:"model",rawName:"v-model",value:e.editMealForm.name,expression:"editMealForm.name"}],staticClass:"u-mealname",attrs:{placeholder:"请输入名称"},domProps:{value:e.editMealForm.name},on:{input:function(t){t.target.composing||e.$set(e.editMealForm,"name",t.target.value)}}}),e._v(" "),i("span",{staticClass:"u-mealtip"},[e._v("价目表")])]),e._v(" "),i("el-table",{staticStyle:{width:"100%"},attrs:{data:e.editMealForm.mealItemsList}},[i("el-table-column",{attrs:{prop:"name",label:"名称",align:"center",width:"350"},scopedSlots:e._u([{key:"default",fn:function(t){return[i("el-input",{staticClass:"u-bold",attrs:{size:"small",placeholder:"例如小型犬、中型犬、大型犬"},model:{value:t.row.name,callback:function(i){e.$set(t.row,"name",i)},expression:"scope.row.name"}})]}}])}),e._v(" "),i("el-table-column",{attrs:{prop:"originalPrice",label:"原价",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[i("div",{staticClass:"flex align-center justify-center p-1"},[i("g-number",{staticClass:"u-bold",attrs:{size:"small"},model:{value:t.row.originalPrice,callback:function(i){e.$set(t.row,"originalPrice",i)},expression:"scope.row.originalPrice"}}),e._v(" "),i("span",{staticClass:"ml-1"},[e._v("元")])],1)]}}])}),e._v(" "),i("el-table-column",{attrs:{prop:"memberPrice",label:"会员价",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[i("div",{staticClass:"flex align-center justify-center p-1"},[i("g-number",{staticClass:"u-bold",attrs:{size:"small"},model:{value:t.row.memberPrice,callback:function(i){e.$set(t.row,"memberPrice",i)},expression:"scope.row.memberPrice"}}),e._v(" "),i("span",{staticClass:"ml-1"},[e._v("元")])],1)]}}])}),e._v(" "),i("el-table-column",{attrs:{prop:"action",label:"操作",align:"center",width:"120"},scopedSlots:e._u([{key:"default",fn:function(t){return[i("el-button",{attrs:{size:"mini",type:"danger",icon:"el-icon-delete",circle:""},on:{click:function(i){return e.delMealItems(t.$index)}}})]}}])})],1),e._v(" "),i("div",{staticClass:"u-add",on:{click:e.addMealItems}},[i("div",{staticClass:"u-add__line"}),e._v(" "),i("div",{staticClass:"u-add__btn"},[i("i",{staticClass:"el-icon-circle-plus"}),e._v(" "),i("span",[e._v("添加收费区间")])]),e._v(" "),i("div",{staticClass:"u-add__line"})])],1),e._v(" "),i("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[i("el-button",{on:{click:function(t){e.dialogVisible=!1}}},[e._v("取 消")]),e._v(" "),i("el-button",{attrs:{type:"primary"},on:{click:e.saveOrUpdate}},[e._v("确 定")])],1)])],1)},n=[function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"u-table__header"},[i("div",{staticClass:"title-1"},[e._v("服务类型")]),e._v(" "),i("div",{staticClass:"title-2"},[e._v("服务内容")]),e._v(" "),i("div",{staticClass:"title-3"},[e._v("价格明细")])])}],s=(i("ac6a"),i("7f7f"),i("2ef0")),r=i.n(s),l=i("22ce"),o=i("c592"),c={name:"Service",components:{GNumber:o["a"]},data:function(){return{dialogVisible:!1,editMealForm:{id:"",name:"",category:"",discountType:0,mealItemsList:[]},list:[{name:"洗澡",icon:"http://mall.gohipet.com/img/icon-shower.6c441e90.png",children:[]},{name:"美容",icon:"http://mall.gohipet.com/img/icon-hairdressing.9f74ab6f.png",children:[]},{name:"寄养",icon:"http://mall.gohipet.com/img/icon-foster.8e6b170f.png",children:[]},{name:"单项",icon:"http://mall.gohipet.com/img/icon-itemService.7d09442a.png",children:[]},{name:"其他",icon:"http://mall.gohipet.com/img/icon-else.6e63dc20.png",children:[]}]}},mounted:function(){this.getList()},methods:{saveOrUpdate:function(){var e=this,t=this.editMealForm;if(!t.name)return this.$message.warning("请输入价目表名称！");for(var i=0;i<t.mealItemsList.length;i++){var a=t.mealItemsList[i];if(!a.name)return this.$message.warning("请输入类目名称！");if(!a.originalPrice)return this.$message.warning("请输入原价！")}l["a"].saveOrUpdate({mealInfo:{id:t.id,name:t.name,category:t.category,discountType:t.discountType},mealItemList:t.mealItemsList}).then((function(){e.$message.success("操作成功"),e.dialogVisible=!1,e.getList()}))},addMeal:function(e){this.editMealForm={id:"",name:"",category:e,discountType:0,mealItemsList:[]},this.dialogVisible=!0},editMeal:function(e){this.editMealForm={id:e.id,name:e.name,category:e.category,discountType:e.discountType,mealItemsList:r.a.cloneDeep(e.mealItemsList)||[]},this.dialogVisible=!0},addMealItems:function(){this.editMealForm.mealItemsList.push({name:"",originalPrice:"",memberPrice:""})},delMealItems:function(e){this.editMealForm.mealItemsList.splice(e,1)},getList:function(){var e=this;l["a"].queryTreeList({pageSize:999,pageNo:1}).then((function(t){var i=r.a.get(t.data,"items",[]);e.list.forEach((function(e){return e.children=[]})),i.forEach((function(t){var i={"洗澡":0,"美容":1,"寄养":2,"单项":3,"其他":4};e.list[i[t.category]].children.push(t)}))}))}}},u=c,d=(i("66c4"),i("2877")),m=Object(d["a"])(u,a,n,!1,null,"0e648fa0",null);t["default"]=m.exports}}]);