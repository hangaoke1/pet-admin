(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-08f907c8"],{"1e1d":function(t,e,i){},"27eec":function(t,e,i){"use strict";i.r(e);var l=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"u-cash flex flex-column p-2 bg-bai"},[i("div",{staticClass:"u-bill flex-0 flex align-center"},[i("span",{staticClass:"u-bill__add el-icon-plus px-1",on:{click:t.addBill}}),t._v(" "),i("div",{staticClass:"u-bill__wrap inline-flex align-center bg-bai text-hui2"},t._l(t.bills,(function(e,l){return i("div",{key:e.name,staticClass:"flex-0",class:{"u-bill__active":e.id===t.billId},on:{click:function(i){t.billId=e.id}}},[i("div",{staticClass:"u-bill__item"},[i("span",{staticClass:"mr-1"},[t._v(t._s(e.title))]),t._v(" "),i("span",{staticClass:"el-icon-close text-base",on:{click:function(i){return i.stopPropagation(),t.delBill(l,e.id)}}})])])})),0)]),t._v(" "),i("div",{staticClass:"flex-1 flex flex-column bg-bai p-2"},[i("div",{staticClass:"flex-0 flex justify-between align-center"},[i("span",{staticClass:"u-add__btn flex-0",on:{click:t.showSkuChoose}},[t._v("添加商品/服务/活体")]),t._v(" "),i("el-input",{staticClass:"u-search",attrs:{size:"small",placeholder:"请输入条形码","prefix-icon":"el-icon-search"},on:{focus:function(e){t.isStart=!1},blur:function(e){t.isStart=!0}},nativeOn:{keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.addSku(e)}},model:{value:t.keyword,callback:function(e){t.keyword=e},expression:"keyword"}})],1),t._v(" "),i("div",{staticClass:"mt-2 flex-1"},[i("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],ref:"multipleTable",staticStyle:{width:"100%"},attrs:{"element-loading-text":"商品查询中","element-loading-spinner":"el-icon-loading","element-loading-background":"rgba(0, 0, 0, 0)",height:"calc(100vh - 280px)",data:t.activeBill.list},on:{"selection-change":t.handleSelectionChange}},[i("el-table-column",{attrs:{type:"selection",width:"55",align:"center"}}),t._v(" "),i("el-table-column",{attrs:{prop:"skuName",label:"商品/服务",width:"180",align:"center"}}),t._v(" "),i("el-table-column",{attrs:{prop:"originPrice",label:"原价(元)",align:"center"}}),t._v(" "),i("el-table-column",{attrs:{prop:"price",label:"售价(元)",align:"center"}}),t._v(" "),i("el-table-column",{attrs:{prop:"count",label:"数量",width:"180",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){var l=e.row;return[i("el-input-number",{attrs:{"controls-position":"right",size:"small",min:1,max:99999},model:{value:l.count,callback:function(e){t.$set(l,"count",e)},expression:"row.count"}})]}}])}),t._v(" "),i("el-table-column",{attrs:{label:"小计(元)",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){var l=e.row;return[i("span",[t._v(t._s((l.count*l.price).toFixed(2)))])]}}])}),t._v(" "),i("el-table-column",{attrs:{label:"操作",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){var l=e.row;return[i("el-button",{attrs:{type:"danger",icon:"el-icon-delete",circle:"",size:"mini"},on:{click:function(e){return t.deleteSku(l)}}})]}}])}),t._v(" "),i("div",{attrs:{slot:"empty"},slot:"empty"},[t._v("请添加商品")])],1)],1)]),t._v(" "),i("div",{staticClass:"u-footer flex-0 flex align-center justify-between"},[i("div",[i("el-button",{attrs:{type:"primary",plain:""}},[t._v("清空列表")])],1),t._v(" "),i("div",[i("button",{staticClass:"u-calc",on:{click:t.doSubmit}},[i("span",{staticClass:"mr-1"},[t._v("结算")]),t._v(" "),i("span",[t._v("¥")]),t._v(" "),i("span",{staticClass:"font-s-28"},[t._v(t._s(t.billTotal.toFixed(2)))])])])]),t._v(" "),i("sku-choose",{ref:"skuChoose"})],1)},n=[],a=(i("ac6a"),i("c4c8")),s=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"u-sku-choose"},[i("el-dialog",{attrs:{"custom-class":"u-sku__dialog",visible:t.visible,width:"880px","show-close":!1},on:{"update:visible":function(e){t.visible=e}}},[i("div",{staticClass:"flex align-center border-bottom-divider p-2",attrs:{slot:"title"},slot:"title"},[i("div",{staticClass:"font-s-18 text-hui font-weight-bold mr-3"},[t._v("服务")]),t._v(" "),i("div",{staticClass:"font-s-18 text-hui font-weight-bold mr-3"},[t._v("商品")]),t._v(" "),i("div",{staticClass:"font-s-18 text-hui font-weight-bold mr-3"},[t._v("活体")])]),t._v(" "),i("div",{staticClass:"flex border-bottom-divider"},[i("div",{staticClass:"u-sku__menu flex-0"},[i("el-tree",{attrs:{data:t.data,props:t.defaultProps}})],1),t._v(" "),i("div",{staticClass:"u-sku__list p-1 flex-1"},[i("div",{staticClass:"flex align-center justify-between py-1"},[i("div",[t._v("所属分类：全部商品")]),t._v(" "),i("el-input",{staticStyle:{width:"150px"},attrs:{size:"mini",placeholder:"搜索商品"}})],1),t._v(" "),i("el-table",{staticStyle:{width:"100%"},attrs:{data:t.tableData}},[i("el-table-column",{attrs:{prop:"date",label:"日期",width:"180"}}),t._v(" "),i("el-table-column",{attrs:{prop:"name",label:"姓名",width:"180"}}),t._v(" "),i("el-table-column",{attrs:{prop:"address",label:"地址"}})],1)],1)]),t._v(" "),i("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[i("el-button",{on:{click:function(e){t.visible=!1}}},[t._v("取 消")]),t._v(" "),i("el-button",{attrs:{type:"primary"},on:{click:function(e){t.visible=!1}}},[t._v("确 定")])],1)])],1)},o=[],r={name:"SkuChoose",data:function(){return{visible:!1,tableData:[{date:"2016-05-02",name:"王小虎",address:"上海市普陀区金沙江路 1518 弄"},{date:"2016-05-04",name:"王小虎",address:"上海市普陀区金沙江路 1517 弄"},{date:"2016-05-01",name:"王小虎",address:"上海市普陀区金沙江路 1519 弄"},{date:"2016-05-03",name:"王小虎",address:"上海市普陀区金沙江路 1516 弄"}],data:[{label:"全部服务",children:[]},{label:"洗澡",children:[{label:"长毛犬"},{label:"短毛犬"},{label:"长毛猫"},{label:"短毛猫"}]},{label:"美容",children:[{label:"犬精修"},{label:"犬清爽剃毛"},{label:"猫美容"},{label:"猫清爽剃毛"}]}],defaultProps:{children:"children",label:"label"}}},methods:{show:function(){this.visible=!0}}},c=r,u=(i("e80b"),i("efe4"),i("2877")),d=Object(u["a"])(c,s,o,!1,null,"45106700",null),f=d.exports,v={name:"Cashier",components:{SkuChoose:f},data:function(){return{visible:!1,isStart:!0,loading:!1,keyword:"",bills:[],billId:""}},computed:{activeBill:function(){var t=this;return this.bills.filter((function(e){return e.id===t.billId}))[0]},billTotal:function(){var t=this.activeBill.list.reduce((function(t,e){return t+e.price*e.count}),0);return t}},watch:{activeBill:function(t){var e=this;this.$nextTick((function(){e.toggleSelection(t.selected)}))}},created:function(){var t=this;this.addBill(),this._scanner=this.$scanner({callback:function(e){t.isStart&&e&&(t.keyword=e,t.addSku())}})},beforeDestroy:function(){this._scanner.cancel()},methods:{showSkuChoose:function(){this.$refs.skuChoose.show()},recoverData:function(){},saveData:function(){},doSubmit:function(){0!==this.activeBill.list.length&&this.$message("订单结算")},toggleSelection:function(t){var e=this;t.forEach((function(t){e.$refs.multipleTable.toggleRowSelection(t,!0)}))},handleSelectionChange:function(t){this.activeBill.selected=t},addBill:function(){var t={id:this.uuid(),title:"账单",list:[],selected:[]};this.bills.push(t),this.billId=t.id},delBill:function(t,e){if(1!==this.bills.length){var i;if(this.billId===e)i=t>0?this.bills[t-1].id:this.bills[t+1].id,this.billId=i;this.bills.splice(t,1)}},deleteSku:function(t){this.activeBill.selected=this.activeBill.selected.filter((function(e){return e.skuCode!==t.skuCode})),this.activeBill.list=this.activeBill.list.filter((function(e){return e.skuCode!==t.skuCode}))},addSku:function(){var t=this;this.loading=!0,a["a"].querySkuByCode({code:this.keyword}).then((function(e){if(e.data){var i=t.activeBill.list,l=e.data;l.count=1;var n=i.filter((function(t){return t.skuCode===l.skuCode}))[0];n?n.count+=1:t.activeBill.list.push(l),t.keyword=""}else t.$message.warning("为查询到商品")})).catch((function(){})).finally((function(){t.loading=!1}))}}},b=v,h=(i("6acb"),Object(u["a"])(b,l,n,!1,null,"187afbe2",null));e["default"]=h.exports},"365c":function(t,e,i){"use strict";i.d(e,"a",(function(){return f}));var l=i("db72"),n=i("bc3a"),a=i.n(n),s=i("5c96"),o=i("4360"),r=i("5f87"),c=a.a.create({baseURL:"http://admin.petcdd.com",withCredentials:!0,timeout:5e3});c.interceptors.request.use((function(t){return o["a"].getters.token&&(t.headers["Authorization"]=Object(r["a"])()),t}),(function(t){return Promise.reject(t)})),c.interceptors.response.use((function(t){var e=t.data;return 200!==e.code?(Object(s["Message"])({message:e.message||"Error",type:"error",duration:5e3}),900===e.code&&"/login"!==window.gvm.$route.path&&s["MessageBox"].confirm("登录状态已经过期",{confirmButtonText:"重新登录",cancelButtonText:"取消",type:"warning"}).then((function(){o["a"].dispatch("user/resetToken").then((function(){location.reload()}))})),Promise.reject(new Error(e.message||"Error"))):e}),(function(t){return console.log("接口异常"+t),Object(s["Message"])({message:t.message,type:"error",duration:5e3}),Promise.reject(t)}));var u=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return c.get(t,Object(l["a"])({params:e},i))},d=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return c.post(t,e,i)},f={get:u,post:d}},"4c51":function(t,e,i){},"6acb":function(t,e,i){"use strict";var l=i("4c51"),n=i.n(l);n.a},afc7:function(t,e,i){},c4c8:function(t,e,i){"use strict";var l=i("365c");e["a"]={queryProducts:function(t){return l["a"].post("/admin/queryProducts",t)},queryProductFullInfoById:function(t){return l["a"].get("/admin/queryProductFullInfoById",t)},queryProductCategory:function(t){return l["a"].post("/admin/queryProductCategory",t)},insertProduct:function(t){return l["a"].post("/admin/insertProduct",t)},updateProduct:function(t){return l["a"].post("/admin/updateProduct",t)},deleteProduct:function(t){return l["a"].post("/admin/deleteProduct",t)},querySkuByCode:function(t){return l["a"].get("/admin/querySku/byCode",t)}}},e80b:function(t,e,i){"use strict";var l=i("1e1d"),n=i.n(l);n.a},efe4:function(t,e,i){"use strict";var l=i("afc7"),n=i.n(l);n.a}}]);